jQuery(document).ready(function(a){function c(b){var c=b+"  .booking-item-payment",d=a(c);a.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:{action:"modal_get_cart_detail"},success:function(a){d.html(a)},error:function(a){}})}function d(b){if(b.length){var c=b.offset().top;a("#wpadminbar").length&&"fixed"==a("#wpadminbar").css("position")&&(c-=32),c-=300,a("html,body").animate({scrollTop:c},500)}}function e(b,c,e){"undefined"==typeof e&&(e="infomation");var f='<div class="alert alert-'+e+'">'+c+"</div>";b.length&&(b.html(""),b.html(f),console.log(b.offset().top),console.log(a(window).height()),b.offset().top>a(window).height()&&d(b))}function g(c,d){function j(a){var b=a.find(".captcha_box");url=b.find(".captcha_img").attr("src"),b.find(".captcha_img").attr("src",url)}var e=d,f=c.serializeArray();f.push({name:"action",value:"booking_form_direct_submit"}),c.find(".form-control").removeClass("error"),c.find(".form_alert").addClass("hidden");for(var g={},h=!0,i=0;i<f.length;++i)g[f[i].name]=f[i].value;return a("input.required,select.required,textarea.required",c).removeClass("error"),a("input.required,select.required,textarea.required",c).each(function(){a(this).val()||(a(this).addClass("error"),h=!1)}),0==h?(c.find(".form_alert").addClass("alert-danger").removeClass("hidden"),c.find(".form_alert").html(st_checkout_text.validate_form),!1):g.term_condition?(g.order_id=b,e.addClass("loading"),void a.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:g,success:function(d){e.removeClass("loading"),d.message&&(c.find(".form_alert").addClass("alert-danger").removeClass("hidden"),c.find(".form_alert").html(d.message)),d.redirect&&(window.location.href=d.redirect),d.redirect_form&&a("body").append(d.redirect_form),"undefined"!=typeof d.order_id&&d.order_id&&(b=d.order_id),d.new_nonce;"st_recaptchar_"+g.item_id;j(c)},error:function(a){alert("Ajax Fail");"st_recaptchar_"+g.item_id;j(c),e.removeClass("loading")}})):(c.find(".form_alert").addClass("alert-danger").removeClass("hidden"),c.find(".form_alert").html(st_checkout_text.error_accept_term),!1)}var b=!1;a(".btn-st-add-cart").click(function(){for(var d=a(this),f=[],g=a(".message_box"),h=a("#form-booking-inpage").serializeArray(),i=0;i<h.length;i++)f.push({name:h[i].name,value:h[i].value});f.push({name:"action",value:"st_add_to_cart"});for(var j={},i=0;i<f.length;++i)j[f[i].name]=f[i].value;d.addClass("loading"),g.html(""),a.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:j,success:function(f){d.removeClass("loading"),f.message&&e(g,f.message,"danger"),f.status&&(a.magnificPopup.open({items:{type:"inline",src:d.data("target")},close:function(){b=!1}}),c(d.data("target")))},error:function(a){d.removeClass("loading")}})}),a(".btn-st-show-cart-modal").click(function(){var d=a(this);a.magnificPopup.open({items:{type:"inline",src:d.data("target")},close:function(){b=!1}}),c(d.data("target"))}),a(document).on("click",".btn-st-checkout-submit",function(){var b=a(this).parents(".booking_modal_form");g(b,a(this))}),a(".payment-item-radio").on("ifChecked",function(){var b=a(this).closest("li.payment-gateway");id=b.data("gateway"),b.addClass("active").siblings().removeClass("active"),a('.st-payment-tab-content .st-tab-content[data-id="'+id+'"]').siblings().fadeOut("fast"),a('.st-payment-tab-content .st-tab-content[data-id="'+id+'"]').fadeIn("fast")})});